
{% extends 'base.html' %}
{% load static %}

{% block main %}


		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


		<div class="colorlib-loader"></div>
		{% if messages %}
													
															
															 
															
														
		{% for message in messages %}
		<div class="alert alert-primary" style="display: none;"
			id="couponUsed" role="alert">
			{{ message }} 
		</div>
		{% endfor %}
		{% endif %}

		<div id="page">
			<div class="breadcrumbs">
				<div class="container">
					<div class="row">
						<div class="col">
							<p class="bread"><span><a href="/">Home</a></span> / <span><a href="/cart">Cart</a></span> /
								<span>Checkout</span>
							</p>
						</div>
					</div>
				</div>
			</div>

			<div class="colorlib-product">
				<div class="container">
					<div class="container mt-5 ">
						<div class="row ">
						  <div style="margin: auto;border-radius: 20px;" class="col-12 col-md-10 hh-grayBox pt45 pb20 text-center">
							<div class="row justify-content-between">
							  <div class="order-tracking">
								<span class="is-complete bg-success"></span>
								<p>Shopping Cart<br><span></span></p>
							  </div>
							  <div class="order-tracking">
								<span class="is-complete bg-success"></span>
								<p>Checkout<br><span></span></p>
							  </div>
							  <div class="order-tracking">
								<span class="is-complete"></span>
								<p>Order Complete<br><span></span></p>
							  </div>
							</div>
						  </div>
						</div>
					  </div>
					<div class="row">
						<div class="col-lg-12">
							<div class="row">
								{% if profile %}
								{% for p in profile %}
										<div class="col-md-6">
											<div class="col mb-3  ">
												<div class="card border">
													<div class="card-body">
														<h5 class="card-title" style="font-weight: 700;">
															{{p.user.username}}{{p.last_name}}
														</h5>
														<p class="card-text" style="font-weight: 700;">
															{{p.house_name}} , {{p.local_place}} - {{p.pin_code}} <br>
																		{{p.town_city}} , {{p.discrict}} 
																					<br>
																					{{p.user.email}} , {{p.mobile}}<br>
														</p>
														<!-- <button class="btn btn-success float-end"
															style="font-weight: 700;"
															onclick="autoFill('<%=x.fname%>','<%=x.lname%>','<%=x.house%>','<%=x.localplace%> ','<%=x.towncity%>','<%=x.district%>','<%=x.state%>','<%=x.pin%>','<%=x.email%>','<%=x.mobile%>')">Auto
															Fill</button> -->
													</div>
												</div>
											</div>
										</div>
										{% endfor %}
											{% else %}
												<a href="/profile_page" style="width: 25%;margin: auto;"
													class="btn btn-success px-4 mb-3 mt-3">Add New Address</a>
												{% endif %}
													<hr>
													<!-- <div>
														<h5 class="text-center">OR-Enter New Address</h5>
													</div>
													<hr>
							</div>
							<form method="post" class="colorlib-form" id="checkout-form" autocomplete="on">
								<h2>Delivery Address</h2>
								<div class="row">


									<div class="col-md-6">
										<div class="form-group">
											<label for="fname">First Name</label>
											<input type="text" id="fname" name="fname" class="form-control"
												placeholder="Your firstname" required>
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="lname">Last Name</label>
											<input type="text" id="lname" name="lname" class="form-control"
												placeholder="Your lastname" required>
										</div>
									</div>



									<div class="col-md-6">
										<div class="form-group">
											<label for="fname">House Name</label>
											<input type="text" id="house" name="house" class="form-control"
												placeholder="Enter Your House Name" required>
										</div>

									</div>

									<div class="col-md-6">
										<div class="form-group">
											<label for="companyname">Local Place</label>
											<input type="text" id="localplace" name="localplace" class="form-control"
												placeholder="Town or City" required>
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="companyname">Town/City</label>
											<input type="text" id="towncity" name="towncity" class="form-control"
												placeholder="Town or City" required>
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="companyname">District</label>
											<input type="text" id="district" name="district" class="form-control"
												placeholder="Town or City" required>
										</div>
									</div>

									<div class="col-md-6">
										<div class="form-group">
											<label for="stateprovince">State</label>
											<input type="text" id="state" name="state" class="form-control"
												placeholder="State " required>
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="lname">PIN Code</label>
											<input type="number" id="pin" name="pin" class="form-control"
												placeholder="PIN Code" required>
										</div>
									</div>

									<div class="col-md-6">
										<div class="form-group">
											<label for="email">E-mail Address</label>
											<input type="email" id="email" name="email" class="form-control"
												placeholder="Email" required>
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="Phone">Mobile Number</label>
											<input type="number" id="mobile" name="mobile" class="form-control"
												placeholder="Mobile" required>
										</div>
									</div>
 --> 

								</div>
								<hr>
								<div class="row">

								</div>
								<div class="row">
									<div class="col-lg-6">
										<div class="cart-detail border">
											<h4>Cart Total</h4>
											<hr>
											<ul>
												<li>
													<strong><span>Total Items</span> <span>
															{{i}} Items 
														</span></strong>
													<ul>
														{% for c in cart %}
															<li><span>
																	  {{c.Lap_name}}
																</span> <span>
																{{c.Lap_name.discounted_price}}   ({{c.quantity}} Items)
																</span></li>
															
															<!-- <li><span>1 x </span> <span>RS.0.00</span></li> -->
															{% endfor %}
													</ul>
												</li>
												<li><span>Shipping</span> <span>0.00</span></li>
												{% if  coupon_amount %}
												<li><span id="discountLabel">Coupon
														discount</span><span id="discountspan">
														0</span></li>
														{% endif %}
												<li><strong><span>Order Total</span> <span id="totalOriginal">
													
													{{famount}}
														</span></strong></li>
											
											</ul>
											<!-- Coupon starting  -->
											<div class="your-order-bottom">
												<div class="discount-code">
													<!-- Button trigger modal -->
													{% if coupon %}
													<button type="button" class="btn btn-link float-end"
														data-toggle="modal" data-target="#exampleModalCenter">
														Get New Coupon
													</button>
													{% endif %}
													<p>Enter your coupon code if you have one.</p>



													<form action="{% url 'checkout' %}" method="post">
														{% csrf_token %}
													<input type="text" class="form-control" name="coupon"
														id="couponInput" autocapitalize="on"/>
													<input type="text" id="couponTotal" name="total" value="<%=total%>"
														hidden>
													<input type="text" id="code" name="Coupon_code" hidden>
													<input type="submit"
														class="btn bg-success text-white text-center  mt-2"
														style="width: 100%;text-decoration: none;">

														</input>

													</form>

													<div class="mt-2">


														 <!-- <div class="alert alert-danger" style="display: none;"
															id="couponInvalid" role="alert">
															This Coupon is
															invalid
														</div>
														<div class="alert alert-success" style="display: none;"
															id="couponSuccess" role="alert">
															Coupon Applied
															Successfully
														</div>
														<div class="alert alert-warning" style="display: none;"
															id="couponExpired" role="alert">
															Sorry!!! Your
															Coupon has been Expired
														</div>

														<div class="alert alert-warning" style="display: none;"
															id="couponMaxLimit" role="alert">
															Sorry!!! Your
															Coupon Has Reached Maximum Limit
														</div> -->
													</div>
												</div>
											</div>
										</div>

									</div>



									<!-- Modal -->

									<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
										aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered" role="document">
											<div class="modal-content">

												<div class="modal-header">
													<h3 class="modal-title" id="exampleModalLongTitle">All Available
														Coupons</h3>
													<button type="button" class="close" data-dismiss="modal"
														aria-label="Close">
														<span aria-hidden="true">&times;</span>
													</button>

												</div>
												{%if coupon %}
												{% for coupon_dic in coupon %}
													<div class="modal-body">
														<div class="row ">
															<div class="col-12 ">
																
																<div class="card">
																	<div class="card-body">
																		<h1 class="card-title">
																			{{coupon_dic.code}}
																		</h1>
																		<p class="card-text">You Can get <strong>
																			{{coupon_dic.amount}}
																				
																			</strong> Discount for this Coupon</p>
																		<p> Is Expired  : In 78 days@
																		</p>
																		
																	</div>
																</div>
															</div>
														</div>
													</div>
													{% endfor %}
													{% endif %}
													
														<div class="modal-footer"></div>

											</div>
										</div>
									</div>

								<!-- Modal end -->

									<div class="col-lg-6">
										<div class="cart-detail border">
											<h4>Payment Method</h4>
											<hr>
											<div class="form-group">
												<div class="col-md-12">
													<div class="radio">
														<label><input type="radio" name="paymentMethod" value="cod"
																required>
															COD</label>
													</div>
												</div>
											</div>
											<div class="form-group">
												<div class="col-md-12">
													<div class="radio">
														<label><input type="radio" name="paymentMethod"
																value="razorpay"> Razorpay {{request.user}}</label>
													</div>
												</div>
											</div>
											<div class="form-group">
												<div class="col-md-12">
													<div class="radio">
														<label><input type="radio" name="paymenMethod" value="paypal">
															Paypal</label>
													</div>
												</div>
											</div>

										</div>
									</div>
								</div>
								<input type="text" name="userId" value="<%=userData._id%>" hidden>
								<hr>

								<div class="row">
									<div class="col-md-12 text-center">
										
{% if payment %}
		
<form action="{% url 'payment_done' %}" method="POST">
	{% csrf_token %}
	<script
		src="https://checkout.razorpay.com/v1/checkout.js"
		data-key="rzp_test_wcSyrPoEa0dNYb" // Enter the Test API Key ID generated from Dashboard → Settings → API Keys
		data-amount="{{razoramount}}" // Amount is in currency subunits. Hence, 29935 refers to 29935 paise or ₹299.35.
		data-currency="INR"// You can accept international payments by changing the currency code. Contact our Support Team to enable International for your account
		data-order_id="{{ payment.razorpay_order_id }}"// Replace with the order_id generated by you in the backend.
		data-name="Sarfas MOHD"
		data-description="Django and Data Science"
		data-image="https://example.com/your_logo.jpg"
		data-prefill.name="PC"
		data-prefill.email="{{email}}"
		data-theme.color="#F37254"
	></script>
	<input type="hidden" name="name" value="{{request.user}}">
</form>
	{% endif %}	
										<!-- <button class="btn btn-success" type="submit">CHECHOUT</button> -->
									</div>
								</div>
							</form>
						</div>

						<div class="col-lg-4">


						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="gototop js-top">
			<a href="#" class="js-gotop"><i class="ion-ios-arrow-up"></i></a>
		</div>
		<!--Sweet Alert CDN-->
		<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		
		
			 <style>
				
		
				.hh-grayBox {
				 
				  margin-bottom: 20px;
				  padding: 35px;
				  margin-top: 20px;
				}
		
				.pt45 {
				  padding-top: 45px;
				}
		
				.order-tracking {
				  text-align: center;
				  width: 33.33%;
				  position: relative;
				  display: block;
				}
		
				.order-tracking .is-complete {
				  display: block;
				  position: relative;
				  border-radius: 50%;
				  height: 30px;
				  width: 30px;
				  border: 0px solid #AFAFAF;
				  background-color: #f7be16;
				  margin: 0 auto;
				  transition: background 0.25s linear;
				  -webkit-transition: background 0.25s linear;
				  z-index: 2;
				}
		
				.order-tracking .is-complete:after {
				  display: block;
				  position: absolute;
				  content: '';
				  height: 14px;
				  width: 7px;
				  top: -2px;
				  bottom: 0;
				  left: 5px;
				  margin: auto 0;
				  border: 0px solid #AFAFAF;
				  border-width: 0px 2px 2px 0;
				  transform: rotate(45deg);
				  opacity: 0;
				}
		
				.order-tracking.completed .is-complete {
				  border-color: #27aa80;
				  border-width: 0px;
				  background-color: #27aa80;
				}
		
				.order-tracking.completed .is-complete:after {
				  border-color: #fff;
				  border-width: 0px 3px 3px 0;
				  width: 7px;
				  left: 11px;
				  opacity: 1;
				}
		
				.order-tracking p {
				  color: #A4A4A4;
				  font-size: 16px;
				  margin-top: 8px;
				  margin-bottom: 0;
				  line-height: 20px;
				}
		
				.order-tracking p span {
				  font-size: 14px;
				}
		
				.order-tracking.completed p {
				  color: #000;
				}
		
				.order-tracking::before {
				  content: '';
				  display: block;
				  height: 3px;
				  width: calc(100% - 40px);
				  background-color: #f7be16;
				  top: 13px;
				  position: absolute;
				  left: calc(-50% + 20px);
				  z-index: 0;
				}
		
				.order-tracking:first-child:before {
				  display: none;
				}
		
				.order-tracking.completed:before {
				  background-color: #27aa80;
				}
			  </style>
		
	
	
	

	<style>
		.razorpay-payment-button{
			background: #28a745;
    	color: #fff;
    	border: 1px solid #28a745;
			height: 50px;
			width: 250px;			
			border-radius: 20px;
			margin-left: auto;
			margin-right: auto;
    margin-right: 4px;
    margin-bottom: 4px;
    font-size: 14px !important;
    font-weight: 400;
		}
	</style>
		{% endblock main %}
		